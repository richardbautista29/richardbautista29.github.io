<html>
<head>
<title></title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script>
$(document).ready(function(){
	
	$('#getdata').click(function(){
	
		$('#result').html("");
		$('#forSharing').html("");
		
		runNow();
	});
	
	setInterval(function () {document.getElementById("getdata").click();}, 10000);
	
	
});
</script>

</head>
<body>
<script>

	var accessToken = "";
	
	var rankings = [];
	
	function runNow()
	{
		
		FB.init({
		  appId            : '556278011536079',
		  autoLogAppEvents : true,
		  xfbml            : true,
		  version          : 'v6.0'
		});
		
		rankings = [];
		accessToken = $('#accessTok').val();
		reactNum = $('#minReact').val();
	
		FB.api(
	  '/103424014687723_103617644668360/comments',
	  'GET',
	  {"filter":"toplevel","summary":"1","order":"chronological","limit":"1000","fields":"id,from","access_token" : accessToken},
	  function(response) {
		  for(i=0; i<response.data.length; i++)
		  {
			getReactions(response.data[i].from.name, response.data[i].id, reactNum);
		  }
			
	  }
	);
	
	}
	
	
  window.fbAsyncInit = function() {
    FB.init({
      appId            : '556278011536079',
      autoLogAppEvents : true,
      xfbml            : true,
      version          : 'v6.0'
    });
	
  };
  
  function getReactions(name,id,reactNum)
  {
	FB.api(
	  id + '?fields=reactions.summary(total_count)',
	  'GET',
	  {"access_token" : accessToken},
	  function(response) {
		  if(response.reactions.summary.total_count > reactNum)
		  {
			  var strId = ('' + id).replace('103617644668360_','');
			  rankings.push({
							"totCount" : response.reactions.summary.total_count,
							"name" : name,
							"id" : strId
							});
			  
			  rankings.sort((a, b) => b.totCount - a.totCount);
			  
			  
			var strDisplay = "";
			var strShare = "QuaranTreats's Cutest Quarantine Pic Challenge<br><br>TOP 20 as of " + new Date().toLocaleString() + "<br><br>";
			for(j=0;j<rankings.length;j++)
			{
				strDisplay = strDisplay + (j+1) + ". " + rankings[j].name + ", (" + rankings[j].totCount + " reactions), <a href = 'https://www.facebook.com/quarantreats2020/posts/103617644668360?comment_id=" + rankings[j].id + "'>VISIT</a><br>";
				strShare = strShare + (j+1) + ". " + rankings[j].name + ", (" + rankings[j].totCount + " reactions)<br>";
				
				if(j==9)
				{
					strDisplay = strDisplay + "<br>NOTE: Top 10 lang po ang may prize!<br><br>";
					strShare = strShare + "<br>NOTE: Top 10 lang po ang may prize!<br><br>";
				}
				
			}
			
			//$('#result').html(strDisplay);
			$('#forSharing').html(strShare);
			  
			  
			  //document.write(name + "," + response.reactions.summary.total_count + ", <a href = 'https://web.facebook.com/quarantreats2020/posts/103617644668360?comment_id=" + strId + "'>VISIT</a><br>");
		  }
	  }
	);  
  
  }
  
  
  
  
</script>
<script async defer src="https://connect.facebook.net/en_US/sdk.js"></script>

Access Token: <input type = "text" id = "accessTok" /><br>
Pull entries with more than: <input type = "text" id = "minReact" /> reactions.
<input type = "button" id = "getdata" value = "GO!" />


<div id = "forSharing">
</div>
<br><br>
<div id = "result">
</div>

</body>
</html>
